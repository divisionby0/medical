var __extends=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};console.log("IM constants");var BENEFIT_AMOUNT="benefitAmount",DEDUCTIBLE="deductible",RATE="rate",DEDUCTIBLE_AMOUNT_OPTION="deductibleAmountOption",SCCC_MAP_ID="scccMap",STANDARD_RATES_MAP_ID="standardRatesMap",AGE_FROM="ageFrom",AGE_TILL="ageTill",STABLE_CHRONIC_CONDITION_OPTION="scco",MEDICAL_DECLARATION_REQUIRED="mdr",PREMIUM_TABLE="premiumTable",SURCHARGE_OR_DISCOUNT="surchargeOrDiscount",AGGREGATE_POLICY_LIMIT="aggregatePolicyLimit",RATES_TABLE_ID="ratesTable",RATE_TABLE_EDITOR_ID="rateTableEditor",RATE_AGE_FROM_SELECT_ID="rateAgeFromSelect",RATE_AGE_TILL_SELECT_ID="rateAgeTillSelect",SCCO_SELECT_ID="sccoSelect",MEDICAL_DECLARATION_REQUIRED_SELECT_ID="medicalDeclarationRequiredSelect",PREMIUM_TABLE_SELECT_ID="premiumTableSelect",RATE_NORMAL_DEDUCTIBLE_AMOUNT_SELECT_ID="rateNormalDeductibleAmountSelect",NEW_RATE_DIALOG_CONTENT="newRateDataDialogContent",NEW_RATE_DIALOG_OK_BUTTON="newRateDialogOkButton",NEW_RATE_DIALOG_CANCEL_BUTTON="newRateDialogCancelButton",NEW_DEDUCTIBLE_AMOUNT_OPTION_DIALOG_CONTENT="newDeductibleAmountOptionDialogContent",PRIMARY="Primary",SCCC_TABLE="SCCC_TABLE",STANDARD_RATES_TABLE="STANDARD_RATES_TABLE",COLLECTION_ITEM_ADDED="COLLECTION_ITEM_ADDED",BENEFITS_COLLECTION_EMPTY="BENEFITS_COLLECTION_EMPTY",COLLECTION_CHANGED="COLLECTION_CHANGED",BENEFITS_COLLECTION_NOT_EMPTY="BENEFITS_COLLECTION_NOT_EMPTY",COLLECTION_ITEM_REMOVED="COLLECTION_ITEM_REMOVED",ON_RATE_ADDED="ON_RATE_ADDED",ON_RATE_REMOVED="ON_RATE_REMOVED",NEW_TABLE_ROW_ADDED="NEW_TABLE_ROW_ADDED",REMOVE_RATE_REQUEST="REMOVE_RATE_REQUEST",REMOVE_DEDUCTIBLE_AMOUNT_OPTION_REQUEST="REMOVE_DEDUCTIBLE_AMOUNT_OPTION_REQUEST",NEW_DEDUCTIBLE_AMOUNT_OPTION_REQUEST="NEW_DEDUCTIBLE_AMOUNT_OPTION_REQUEST",NEW_DEDUCTIBLE_AMOUNT_OPTION_CREATION="NEW_DEDUCTIBLE_AMOUNT_OPTION_CREATION",ON_DEDUCTIBLE_AMOUNT_OPTIONS_DATA="ON_DEDUCTIBLE_AMOUNT_OPTIONS_DATA";console.log("Im ages");var MIN_AGE=0,MAX_AGE=99,AgeRangeValidator=function(){return{validate:function(t,e){var n=parseInt(t)>parseInt(e),o=parseInt(t)==parseInt(e);return!n&&!o}}},AgeRangeFormatter=function(){return{format:function(t,e){var n=parseInt(t),o=parseInt(e),i=parseInt(MIN_AGE),r=parseInt(MAX_AGE);return n===i&&o>i?"Under "+o:n>i&&o===r?n+" and over":n+" to "+o},getRangeFromString:function(t){}}},RENDERER_VALUE_CHANGED="RENDERER_VALUE_CHANGED",CLEAR_TABLE_BUTTON_CLICK="CLEAR_TABLE_BUTTON_CLICK";console.log("IM utils");var DateUtils=function(){function t(t){var e=t.toString();return 1==e.length&&(e="0"+e),e}return{getTomorrowDate:function(e){var n,o=(n=e?moment(e,"YYYY-MM-DD").add(1,"days"):moment().add(1,"days")).format("DD"),i=n.format("MM"),r=n.format("YYYY");return o=t(o),i=t(i),r+"-"+i+"-"+o},getCurrentDate:function(){var e=new Date,n=e.getDate(),o=e.getMonth()+1,i=e.getFullYear();return n=t(n),o=t(o),i+"-"+o+"-"+n},parseDate:function(e){e.split("+");var n=moment(e,"YYYY-MM-DD"),o=n.format("DD"),i=n.format("MM"),r=n.format("YYYY");return o=t(o),i=t(i),r+"-"+i+"-"+o},getYearsFromDate:function(t){return moment().diff(t,"years")},parseToArray:function(e){var n=e.split("-"),o=n[0],i=n[1],r=n[2];return r=t(r),i=t(i),[o,i,r]}}}(),Cookie;!function(t){function e(t){for(var e=t+"=",n=document.cookie.split(";"),o=0;o<n.length;o++){for(var i=n[o];" "==i.charAt(0);)i=i.substring(1);if(0==i.indexOf(e))return i.substring(e.length,i.length)}return""}function n(t,e,n){var o=(n=n||{}).expires;if("number"==typeof o&&o){var i=new Date;i.setTime(i.getTime()+1e3*o),o=n.expires=i}o&&o.toUTCString&&(n.expires=o.toUTCString());var r=t+"="+(e=encodeURIComponent(e));for(var a in n){r+="; "+a;var s=n[a];!0!==s&&(r+="="+s)}r+=";path=/",document.cookie=r}function o(){var t=!!navigator.cookieEnabled;return void 0!==navigator.cookieEnabled||t||(document.cookie="testcookie",t=-1!=document.cookie.indexOf("testcookie")),t}function i(){return e("userFormData")}function r(){return o()}function a(t){n("selectedCompany",t,{expires:36e4})}function s(){return e("selectedCompany")}function c(t){n("userPersonalData",t,{expires:36e4})}function u(){return e("userPersonalData")}function l(t){n("persons",t,{expires:36e4})}function d(){return e("persons")}function p(t){n("period",t,{expires:36e4})}function f(){return e("period")}function E(t){n("benefit",t,{expires:36e4})}function h(){return e("benefit")}function T(t){n("plan",t,{expires:36e4})}function g(){return e("plan")}function _(t){n("currentPersonIndex",t,{expires:36e4})}function v(){return e("currentPersonIndex")}function D(t){n("countryOfOrigin",t,{expires:36e4})}function C(){return e("countryOfOrigin")}function m(t){n("visitorType",t,{expires:36e4})}function A(){return e("visitorType")}function I(t){n("arrivalDate",t,{expires:36e4})}function O(){return e("arrivalDate")}function y(t){n("sponsorFirstName",t,{expires:36e4})}function L(){return e("sponsorFirstName")}function N(t){n("sponsorLastName",t,{expires:36e4})}function R(){return e("sponsorLastName")}function M(t){n("beneficiaryFirstName",t,{expires:36e4})}function b(){return e("beneficiaryFirstName")}function B(t){n("beneficiaryLastName",t,{expires:36e4})}function w(){return e("beneficiaryLastName")}function S(t){n("address",t,{expires:36e4})}function U(){return e("address")}function x(t){n("email",t,{expires:36e4})}function P(){return e("email")}function F(t){n("phone",t,{expires:36e4})}function j(){return e("phone")}function G(t){n("quoteId",t,{expires:36e4})}function Q(){return e("quoteId")}function V(t){n("applicationType",t,{expires:36e4})}function k(){return e("applicationType")}function $(t){n("city",t,{expires:36e4})}function q(){return e("city")}function Y(t){n("province",t,{expires:36e4})}function H(){return e("province")}function W(t){n("postalCode",t,{expires:36e4})}function J(){return e("postalCode")}t.getUserInputFormData=i,t.isEnabled=r,t.setSelectedCompanyData=a,t.getSelectedCompanyData=s,t.setUserData=c,t.getUserData=u,t.setPersons=l,t.getPersons=d,t.setPeriod=p,t.getPeriod=f,t.setBenefit=E,t.getBenefit=h,t.setCompanyPlan=T,t.getCompanyPlan=g,t.setCurrentPersonIndex=_,t.getCurrentPersonIndex=v,t.setCountryOfOrigin=D,t.getCountryOfOrigin=C,t.setVisitorType=m,t.getVisitorType=A,t.setArrivalDate=I,t.getArrivalDate=O,t.setSponsorFirstName=y,t.getSponsorFirstName=L,t.setSponsorLastName=N,t.getSponsorLastName=R,t.setBeneficiaryFirstName=M,t.getBeneficiaryFirstName=b,t.setBeneficiaryLastName=B,t.getBeneficiaryLastName=w,t.setAddress=S,t.getAddress=U,t.setEmail=x,t.getEmail=P,t.setPhone=F,t.getPhone=j,t.setQuoteId=G,t.getQuoteId=Q,t.setApplicationType=V,t.getApplicationType=k,t.setSponsorCity=$,t.getSponsorCity=q,t.setSponsorProvince=Y,t.getSponsorProvince=H,t.setSponsorPostalCode=W,t.getSponsorPostalCode=J}(Cookie||(Cookie={}));var MapUtils=function(){return{getMapJson:function(t){return t.getEncoder().encode()},createMapFromJson:function(t){return new MapJsonDecoder(t).decode()},setAllValuesToZero:function(t){for(var e=t.getIterator();e.hasNext();){var n=e.next(),o=n.getKeys();n.clear();for(var i=0;i<o.length;i++){var r=o[i];n.add(r,0)}}}}}(),StringUtils=function(){function t(t){var e=t.toString(),n=e.indexOf(".");return e.replace(/\d(?=(?:\d{3})+(?:\.|$))/g,function(t,e){return n<0||e<n?t+" ":t})}return{formatDivisionalMoney:function(t){var e=t.toString().split("."),n=e[1];return"$ "+e[0]+"."+n.substring(0,2)},formatMoney:function(t){var e=t.toString();return"$ "+e.substring(0,3)+" "+e.substring(3,6)},formatMoneyInt:function(e){return"$ "+t(e)},parseURI:function(t){var e=null;try{t=decodeURIComponent(t)}catch(t){console.error("decodeURIComponent error: "+t)}try{e=JSON.parse(t)}catch(t){return console.error("parse error "+t),null}return e},decodeHTML:function(t){var e=document.createElement("textarea");return e.innerHTML=t,e.value},stripHTML:function(t){return jQuery.noConflict()(t).text()},decorateCardNumber:function(t){for(var e=t.split(""),n=e.length,o="",i=0;i<n;i++)o+=i<n-4?"*":e[i];return o}}}(),TextInputUtils=function(){return{isOnlyNumbersWithDot:function(t){var e;return t.keyCode>0?e=t.which||t.keyCode:void 0!==t.charCode&&(e=t.which||t.keyCode),46==e||45==e||!(e>31&&(e<48||e>57))}}}(),NavigatorUtil=function(){function t(){}return t.navigateTo=function(t){document.location.href=t},t}(),QuoteSaver=function(){function t(){this.$j=jQuery.noConflict()}return t.prototype.save=function(t){var e=this,n={action:"saveApplication",companyName:t.companyName,quoteData:t.quoteData,persons:t.persons,period:t.period,numPersons:t.numPersons,startDate:t.startDate,finishDate:t.finishDate,countryOfOrigin:t.countryOfOrigin,visitorType:t.visitorType,arrivalDate:t.arrivalDate,sponsorFirstName:t.sponsorFirstName,sponsorLastName:t.sponsorLastName,beneficiaryFirstName:t.beneficiaryFirstName,beneficiaryLastName:t.beneficiaryLastName,address:t.address,email:t.email,phone:t.phone,city:t.city,province:t.province,postalCode:t.postalCode,quoteId:t.quoteId,applicationType:t.type};this.$j.post(ajaxurl,n,function(t){return e.onQuoteSaveComplete(t)})},t.prototype.onQuoteSaveComplete=function(t){},t}(),MoneyFormatter=function(){function t(){}return t.format=function(t,e,n,o){var e=isNaN(e=Math.abs(e))?2:e,o=void 0==o?",":o,i=t<0?"-":"",r=String(parseInt(t=Math.abs(Number(t)||0).toFixed(e))),a=(a=r.length)>3?a%3:0;return i+(a?r.substr(0,a)+o:"")+r.substr(a).replace(/(\d{3})(?=\d)/g,"$1"+o)},t}(),PostalCodeValidator=function(){function t(){}return t.validate=function(t){return!!/^[A-Za-z]\d[A-Za-z][ -]?\d[A-Za-z]\d$/.test(t)},t}(),TextLengthValidator=function(){function t(t){this.text=t}return t.prototype.validate=function(t){return this.text.length>t-1},t}();console.log("im collections");var ListIterator=function(){function t(t){this.counter=-1,this.collection=t}return t.prototype.hasNext=function(){return this.counter+1<this.collection.size()},t.prototype.next=function(){return this.counter+=1,this.collection.get(this.counter)},t}(),MapIterator=function(){function t(t){this.counter=-1,this.collection=t,this.keys=this.collection.getKeys()}return t.prototype.hasNext=function(){return this.counter+1<this.keys.length},t.prototype.next=function(){this.counter+=1;var t=this.keys[this.counter];return this.collection.get(t)},t.prototype.size=function(){return this.keys.length},t}(),List=function(){function t(t){t&&(this.id=t),this.items=[]}return t.prototype.size=function(){return this.items.length},t.prototype.add=function(t){this.items.push(t)},t.prototype.get=function(t){return this.items[t]},t.prototype.remove=function(t){this.items.splice(t,1)},t.prototype.clear=function(){this.items=[]},t.prototype.getIterator=function(){return new ListIterator(this)},t.prototype.setId=function(t){this.id=t},t.prototype.getId=function(){return this.id},t}(),Map=function(){function t(t){this.keys=new Array,t&&(this.id=t),this.items={}}return t.prototype.removeKey=function(t){var e=this.keys.indexOf(t);this.keys.splice(e,1)},t.prototype.add=function(t,e){if(this.has(t))throw new Error(t+" already exists");this.items[t]=e,this.keys.push(t)},t.prototype.remove=function(t){delete this.items[t],this.removeKey(t)},t.prototype.update=function(t,e){var n=this.get(t);void 0!=n&&null!=n?this.items[t]=e:console.error("Map error. No such element by key "+t)},t.prototype.clear=function(){this.keys=new Array,this.items={}},t.prototype.has=function(t){return t in this.items},t.prototype.get=function(t){return this.items[t]},t.prototype.getKeys=function(){return this.keys},t.prototype.size=function(){return this.keys.length},t.prototype.getIterator=function(){return new MapIterator(this)},t.prototype.setId=function(t){this.id=t},t.prototype.getId=function(){return this.id},t.prototype.getEncoder=function(){return new MapJsonEncoder(this)},t}(),MapJsonDecoder=function(){function t(t){this.rootMap=new Map("rootMap"),this.dataString=t}return t.prototype.decode=function(){return this.parseStringToMap(this.dataString,this.rootMap),this.rootMap},t.prototype.parseStringToMap=function(t,e){var n="";try{n=JSON.parse(t)}catch(t){console.log("MapJsonDecoder error: Not valid json.")}this.parseObjectToMap(n,e)},t.prototype.parseObjectToMap=function(t,e){t.id;if("Map"==t.type)for(var n in t){var o=t[n],i=o.id,r=o.type;if("id"!=n&&"type"!=n&&"Map"==r){var a=new Map(i);e.add(n,this.parseObjectToMap(o,a))}else"id"===n?e.setId(o):"type"!=n&&e.add(n,o)}return e},t}(),MapJsonEncoder=function(){function t(t){this.collection=t}return t.prototype.encode=function(){var t=this.parseToObject(this.collection);return JSON.stringify(t)},t.prototype.parseToObject=function(t){var e={};e.id=t.getId(),e.type="Map";var n=t.getKeys();for(var o in n){var i=n[o],r=t.get(i),a=r instanceof Map;e[i]=a?this.parseToObject(r):r}return e},t}();console.log("IM EventBus");var EventBus;!function(t){function e(t,e){f.has(t)||a(t),s(e,r(t))}function n(t,e){f.has(t)&&u(e,r(t))}function o(t,e){f.has(t)&&i(r(t),e)}function i(t,e){for(var n=t.getIterator();n.hasNext();)n.next().call(this,e)}function r(t){return f.get(t)}function a(t){var e=c(t);f.add(t,e)}function s(t,e){e.add(t)}function c(t){return new List(t)}function u(t,e){for(var n=e.getIterator(),o=new Array,i=-1;n.hasNext();){i++;var r=n.next();t.toString()==r.toString()&&o.push(i)}l(o,e),d(e)}function l(t,e){if(t.length>0)for(var n=0;n<t.length;n++){var o=t[n];e.remove(o)}}function d(t){0==t.size()&&p(t)}function p(t){var e=t.getId();f.remove(e)}var f=new Map("listeners");t.addEventListener=e,t.removeEventListener=n,t.dispatchEvent=o}(EventBus||(EventBus={})),console.log("Im db");var DB=function(){function t(){}return t.savePersons=function(t,e){var n={action:"saveTempQuotePersons",quoteId:e,data:t};jQuery.noConflict().post(ajaxurl,n,function(t){})},t.loadPersons=function(t){var e={action:"loadTempQuotePersons",quoteId:t};jQuery.noConflict().post(ajaxurl,e,function(t){EventBus.dispatchEvent("personsDataLoadComplete",t)})},t.deletePersons=function(t){var e={action:"removeTempQuotePersons",quoteId:t};jQuery.noConflict().post(ajaxurl,e,function(t){console.log("persons temp record removed data: "+t)})},t}();console.log("IM BenefitsCollectionChangedListener");var BenefitsCollectionChangedListener=function(){function t(t,e){EventBus.addEventListener(COLLECTION_ITEM_ADDED,i),EventBus.addEventListener(COLLECTION_ITEM_REMOVED,i),EventBus.addEventListener(COLLECTION_CHANGED,i)}function e(){EventBus.removeEventListener(COLLECTION_ITEM_ADDED,i),EventBus.removeEventListener(COLLECTION_ITEM_REMOVED,i),EventBus.removeEventListener(COLLECTION_CHANGED,i)}function n(){r.call(this)}function o(){a.call(this)}function i(t){t.type==BENEFIT_AMOUNT&&(0==t.total?n():o())}var r,a;return{init:function(e,n){r=e,a=n,t()},destroy:function(){e()}}};console.log("IM CreateEmptyTableDataProvider");var CreateEmptyTableDataProvider=function(){function t(t){return new Map(t)}return{create:function(e){if(e==SCCC_TABLE)return n=t(SCCC_MAP_ID);if(e==STANDARD_RATES_TABLE){var n=t(STANDARD_RATES_MAP_ID);return n}console.error("Could not create empty table data provider from type "+e)}}}();console.log("IM BaseTable");var BaseTable=function(){function t(t,e,n,o){this.htmlContent="",this.rowMaxLength=100,this.rowStartIndex=0,o&&(this.rowMaxLength=o),n&&(this.rowStartIndex=n),e&&e.size()>0&&(this.data=e,this.createPrefixAndPostfix(t),this.createContent())}return t.prototype.createPrefixAndPostfix=function(t){this.prefix='<b><font color="red">Info: N/A values should set to -1</font></b><table id="'+t+'">',this.postfix="</table>"},t.prototype.createContent=function(){this.createLegendRow(),this.createContentFromData()},t.prototype.createContentFromData=function(){},t.prototype.createRow=function(t){},t.prototype.addLegendRow=function(t){this.htmlContent=this.htmlContent+'<td><b><font color="blue">$'+t.getId()+"</font></b></td>"},t.prototype.createLegendRow=function(){},t.prototype.getHTML=function(){return this.prefix+this.htmlContent+this.postfix},t}();console.log("IM Table");var Table=function(t){function e(e,n,o,i){t.call(this,e,n,o,i)}return __extends(e,t),e.prototype.createContentFromData=function(){for(var t=this.data.getIterator();t.hasNext();){var e=t.next();this.createRow(e)}},e.prototype.createRow=function(e){this.htmlContent=this.htmlContent+'<tr id="'+e.getId()+'">',t.prototype.addLegendRow.call(this,e);for(var n=e.getKeys(),o=0;o<n.length;o++){var i=n[o],r=e.get(i),a=new TextInputItemRenderer("id",r,e.getId(),i).getHTML();this.htmlContent=this.htmlContent+a}this.htmlContent=this.htmlContent+"</tr>"},e.prototype.createLegendRow=function(){this.htmlContent=this.htmlContent+'<tr id="legendRow">',this.htmlContent=this.htmlContent+"<th>Aggregate Policy Limit</th>";for(var t=this.rowStartIndex;t<this.rowMaxLength;t++)this.htmlContent=this.htmlContent+"<th>"+t+" y.o.</th>";this.htmlContent=this.htmlContent+"</tr>"},e}(BaseTable);console.log("IM TableFactory");var TableFactory=function(){return{createTable:function(t,e,n){if(t===SCCC_TABLE)return(o=new Table(e,n)).getHTML();if(t===STANDARD_RATES_TABLE){var o=new Table(e,n);return o.getHTML()}throw new Error('Undefined type "'+t+'"')}}}();console.log("IM ClearTableButton");var ClearTableButton=function(){function t(){e.click(function(){EventBus.dispatchEvent(CLEAR_TABLE_BUTTON_CLICK,{context:n})})}var e,n;return{init:function(o,i){n=i,o?(e=o,t()):console.error("View not set")}}};console.log("IM BaseItemRenderer");var BaseItemRenderer=function(){function t(t,e){this.id=t,this.data=e,this.data&&this.id&&this.getHTML()}return t.prototype.getHTML=function(){return"empty"},t.prototype.clear=function(){},t}();console.log("IM TextInputItemRenderer");var TextInputItemRenderer=function(t){function e(e,n,o,i){t.call(this,e,n),this.rowId=o,this.columnKey=i,this.inputId=this.rowId+"_"+this.columnKey,this.createInput()}return __extends(e,t),e.prototype.setState=function(t){"normal"==t?this.textInput.removeClass("negativeValue"):this.textInput.addClass("negativeValue")},e.prototype.createInput=function(){var t=this.data;-1!=this.data&&"-1"!=this.data&&(t=parseInt(this.data)/1e3);var e=t<0;this.textInput=jQuery('<input class="tableCeilItemRenderer" type="text" id="'+this.inputId+'" value="'+t+'" data-rowid="'+this.rowId+'" data-columnkey="'+this.columnKey+'">'),e&&this.textInput.addClass("negativeValue")},e.prototype.getHTML=function(){return this.textInput?"<td>"+this.textInput.prop("outerHTML")+"</td>":void 0},e}(BaseItemRenderer);console.log("IM CollectionMetaBox");var CollectionMetaBox=function(){function t(){y=b("#"+S)}function e(){L=b("#"+U)}function n(){N=b("#"+x)}function o(){N.change(function(){var t=b(this).val();w=B.get(t)})}function i(){R=b("#"+P)}function r(){M=R.val()}function a(){var t=new MapJsonDecoder(M);try{B=t.decode()}catch(t){return console.error(t),p(),d(),void D()}}function s(){0==B.size()&&(p(),d(),D(),I())}function c(){N.find("option").remove()}function u(){c();for(var t=B.getIterator();t.hasNext();)C(t.next())}function l(t){N.val(t)}function d(){B=new Map(F)}function p(){R.val("")}function f(){y.click(function(){h()})}function E(){L.click(function(){T()})}function h(){var t=prompt("Please enter new "+j+" for company","0");null!=t&&_(t)}function T(){confirm("Remove "+w+" "+j+" ?")&&g()}function g(){B.remove(w),EventBus.dispatchEvent(COLLECTION_ITEM_REMOVED,{type:j,item:w,total:B.size()}),D(),u(),B.size()>0?m():I()}function _(t){if(v(t)){try{B.add(t,t)}catch(t){return void alert(t)}EventBus.dispatchEvent(COLLECTION_ITEM_ADDED,{type:j,item:t,total:B.size()}),A(),D(),C(t),l(t),w=t}else alert("Only numbers require")}function v(t){return/^\d+$/.test(t)}function D(){var t=B.getEncoder();R.val(t.encode())}function C(t){b('<option value="'+t+'">'+t+"</option>").appendTo(N)}function m(){if(B.size()>0){var t=B.getKeys()[0];w=B.get(t)}u(),l(w)}function A(){L.show()}function I(){L.hide()}function O(){EventBus.dispatchEvent(COLLECTION_CHANGED,{type:j,total:B.size()})}var y,L,N,R,M,b,B,w,S,U,x,P,F,j;return{init:function(c,l,d,p,h,T){b=jQuery,j=c,S=l,U=d,x=p,P=h,F=T,t(),f(),e(),E(),i(),n(),o(),r(),a(),s(),u(),O(),m()},getValues:function(){return B.getKeys()}}};console.log("IM RatesMetaBox");var RatesMetaBox=function(){function t(){(q=new BenefitsCollectionChangedListener).init(e,n)}function e(){console.log("RatesMetabox onBenefitsCollectionEmpty")}function n(){console.log("RatesMetabox onBenefitsCollectionNotEmpty")}function o(){S=w("#"+F)}function i(){U=w("#"+j)}function r(){x=U.val()}function a(){var t=new MapJsonDecoder(x);console.log("parsing rates "+x);try{P=t.decode()}catch(t){return void s(t)}}function s(t){console.error(t),d(),l(),O()}function c(){u()||(d(),l(),O())}function u(){return 0!=P.size()}function l(){P=new Map(G)}function d(){U.val("")}function p(){S.click(function(){m()})}function f(){EventBus.addEventListener(REMOVE_RATE_REQUEST,A)}function E(t){var e="ageFrom:"+t.ageFrom+";ageTill:"+t.ageTill+";sccOption:"+t.sccOption+";mdr:"+t.mdr+";premiumTable:"+t.premiumTable+";deductible:"+t.deductible;t.id=e,(new AgeRangeValidator).validate(t.ageFrom,t.ageTill)?T(h(e,t))?(O(),g(t)):console.error("Rate not added"):alert("Rate validation error. AgesSelection incorrect.")}function h(t,e){var n=new Map(t);return n.add(AGE_FROM,e.ageFrom),n.add(AGE_TILL,e.ageTill),n.add(STABLE_CHRONIC_CONDITION_OPTION,e.sccOption),n.add(MEDICAL_DECLARATION_REQUIRED,e.mdr),n.add(PREMIUM_TABLE,e.premiumTable),n.add(DEDUCTIBLE,e.deductible),n}function T(t){var e=t.getId();try{return P.add(e,t),!0}catch(t){return alert(t),!1}}function g(t){EventBus.dispatchEvent(ON_RATE_ADDED,t)}function _(t){EventBus.dispatchEvent(ON_RATE_REMOVED,t)}function v(){w("#"+NEW_RATE_DIALOG_OK_BUTTON).on("click",function(){E({ageFrom:w("#"+RATE_AGE_FROM_SELECT_ID).val(),ageTill:w("#"+RATE_AGE_TILL_SELECT_ID).val(),sccOption:w("#"+SCCO_SELECT_ID).val(),mdr:w("#"+MEDICAL_DECLARATION_REQUIRED_SELECT_ID).val(),premiumTable:w("#"+PREMIUM_TABLE_SELECT_ID).val(),deductible:w("#"+RATE_NORMAL_DEDUCTIBLE_AMOUNT_SELECT_ID).val()}),C()}),w("#"+NEW_RATE_DIALOG_CANCEL_BUTTON).on("click",function(){C()})}function D(){w("#"+NEW_RATE_DIALOG_OK_BUTTON).off("click"),w("#"+NEW_RATE_DIALOG_CANCEL_BUTTON).off("click")}function C(){D(),w("#"+NEW_RATE_DIALOG_CONTENT).dialog("close")}function m(){V=w("#"+NEW_RATE_DIALOG_CONTENT).dialog({modal:!0,width:400}),v()}function A(t){I(t)}function I(t){P.remove(t),O(),_(t)}function O(){var t=P.getEncoder();U.val(t.encode())}function y(){for(var t=0;t<k.length;t++)w('<option value="'+k[t]+'">'+k[t]+"</option>").appendTo("#"+RATE_NORMAL_DEDUCTIBLE_AMOUNT_SELECT_ID)}function L(){EventBus.addEventListener(COLLECTION_ITEM_ADDED,N),EventBus.addEventListener(COLLECTION_ITEM_REMOVED,R)}function N(t){t.type==DEDUCTIBLE&&M(t.item)}function R(t){t.type==DEDUCTIBLE&&b(t.item)}function M(t){w('<option value="'+t+'">'+t+"</option>").appendTo("#"+RATE_NORMAL_DEDUCTIBLE_AMOUNT_SELECT_ID)}function b(t){w("#"+RATE_NORMAL_DEDUCTIBLE_AMOUNT_SELECT_ID+" option[value="+t+"]").remove()}function B(){($=new RatesTableView).init(P)}var w,S,U,x,P,F,j,G,Q,V,k,$,q;return{init:function(e,n,s,u,l,d,E){w=jQuery,Q=e,F=n,j=l,G=d,k=E,t(),o(),i(),r(),a(),c(),y(),L(),B(),p(),f()}}};console.log("IM CreateDeductibleAmountOptionDialog");var CreateDeductibleAmountOptionDialog=function(){function t(){v=L("#"+NEW_DEDUCTIBLE_AMOUNT_OPTION_DIALOG_CONTENT).dialog({modal:!0,width:400})}function e(){y=L("#deductibleAmountOptionAgeTillSelect")}function n(){O=L("#deductibleAmountOptionAgeFromSelect")}function o(){A=L("#addDeductibleAmountOptionConfirmButton")}function i(){I=L("#cancelDeductibleAmountOptionConfirmationButton")}function r(){A.click(function(){a()}),I.click(function(){g()})}function a(){var t=c(),e=O.val(),n=y.val();if((new AgeRangeValidator).validate(e,n)){var o=m.val(),i=C.val(),r=D.val(),a=new DeductibleAmountOption;a.construct(t,e,n,o,i,r),s(a),g()}else alert("AgesSelection incorrect.")}function s(t){EventBus.dispatchEvent(NEW_DEDUCTIBLE_AMOUNT_OPTION_CREATION,t)}function c(){return"ageFrom:"+O.val()+";ageTill:"+y.val()+";surchOrDisc:"+m.val()+";apl:"+C.val()+";deductible:"+D.val()}function u(){m=L("#surchargeOrDiscountInput")}function l(){m.on("keypress",function(t,e){return TextInputUtils.isOnlyNumbersWithDot(t)}),m.on("keyup",function(t,e){var n=parseFloat(L(this).val());n<-100?(n=-100,L(this).val(n)):n>100&&(n=100,L(this).val(n))})}function d(){D=L("#deductibleAmountOptionSelect")}function p(t){for(var e=0;e<t.length;e++){var n=t[e];L('<option value="'+n+'">'+n+"</option>").appendTo(D)}}function f(){D.find("option").remove()}function E(){C=L("#aggregatePolicyLimitSelect")}function h(t){L('<option value="any">any</option>').appendTo(C);for(var e=0;e<t.length;e++){var n=t[e];L('<option value="'+n+'">'+n+"</option>").appendTo(C)}}function T(){C.find("option").remove()}function g(){v.dialog("close")}function _(){v.dialog("open")}var v,D,C,m,A,I,O,y,L=jQuery.noConflict();return{init:function(a,s){o(),i(),r(),n(),e(),u(),l(),d(),p(a),E(),h(s),t(),g()},show:function(){_()},hide:function(){g()},deductiblesChanged:function(t){f(),p(t)},aggregatePolicyChanged:function(t){T(),h(t)}}};console.log("IM DeductibleAmountOptionsView");var DeductibleAmountOptionsView=function(){function t(t){alert(t)}function e(){EventBus.dispatchEvent(ON_DEDUCTIBLE_AMOUNT_OPTIONS_DATA,u.val())}function n(){u=l("#deductibleAmountOptionsTableEditor")}function o(){(r=new AddNewDeductibleAmountOptionButton).init()}function i(){(a=new CreateDeductibleAmountOptionDialog).init(s,c)}var r,a,s,c,u,l=jQuery.noConflict();return{init:function(t,e){n(),s=t,c=e,i(),o()},updateDeductibles:function(t){a.deductiblesChanged(t)},updateAggregatePolicyLimits:function(t){a.aggregatePolicyChanged(t)},onEmptyDeductiblesOrAggregatePolicyLimits:function(){t("Benefits or AggregatePolicyLimits empty.")},showNewOptionDataInput:function(){a.show()},getData:function(){e()},setData:function(t){u.val(t)}}};console.log("IM DeductibleAmountOptionsTableView");var DeductibleAmountOptionsTableView=function(){function t(){var t=n();E(t).dialog({title:"Remove deductible amount option confirmation",modal:!0,width:400,buttons:[{text:"Yes",click:function(){e(),E(this).dialog("close")}},{text:"No",click:function(){E(this).dialog("close")}}]})}function e(){EventBus.dispatchEvent(REMOVE_DEDUCTIBLE_AMOUNT_OPTION_REQUEST,f)}function n(){var t=p.get(f);return"<div>Really want to delete DAO with data:<br/>age from:  "+t.get(AGE_FROM)+"<br/>age till:  "+t.get(AGE_TILL)+"<br/>Surcharge or discount: "+t.get(SURCHARGE_OR_DISCOUNT)+"<br/>Aggregate policy limit:  "+t.get(AGGREGATE_POLICY_LIMIT)+"<br/>deductible:  "+t.get(DEDUCTIBLE)+"</div>"}function o(){i(),E(".removeRowButtonTableItemRenderer[collectiontype="+DEDUCTIBLE_AMOUNT_OPTION+"]").on("click",function(){f=E(this).attr("id"),t()})}function i(){E(".removeRowButtonTableItemRenderer[collectiontype="+DEDUCTIBLE_AMOUNT_OPTION+"]").off("click")}function r(){d=E("#deductibleAmountOptionsTable")}function a(){for(var t=p.getIterator();t.hasNext();){var e=t.next(),n=l(e);s(n),u(e.getId(),n)}}function s(t){t.appendTo(d)}function c(t){t.remove()}function u(t,e){h.add(t,e)}function l(t){var e=t.getId(),n=t.get(AGE_FROM),o=t.get(AGE_TILL),i=t.get(SURCHARGE_OR_DISCOUNT);0==i?i="Use Rate Table":i+=" %";var r=t.get(AGGREGATE_POLICY_LIMIT);-1==r?r="any":r+=" $";var a=t.get(DEDUCTIBLE);a+=" $";var s=(new AgeRangeFormatter).format(n,o);return E('<tr id="'+e+'"><td class="fullwidth centered"><input data-type="'+DEDUCTIBLE_AMOUNT_OPTION+'" collectiontype= "'+DEDUCTIBLE_AMOUNT_OPTION+'" class="removeRowButtonTableItemRenderer" type="button" id="'+e+'" value="Remove"></td><td class="fullwidth centered">'+a+'</td><td class="fullwidth centered">'+i+'</td><td class="fullwidth centered">'+r+'</td><td class="fullwidth centered">'+s+"</td></tr>")}var d,p,f,E=jQuery.noConflict(),h=new Map("rows");return{init:function(){r()},setData:function(t){p=t,a(),o()},onItemAdded:function(t){var e=l(t);s(e),u(t.getId(),e),o()},onItemRemoved:function(t){var e=t.getId(),n=h.get(e);h.remove(e),c(n)}}};console.log("IM DeductibleAmountOptionsModel");var DeductibleAmountOptionsModel=function(){function t(t){var e=a.get(t);return a.remove(t),o(),e}function e(t){var e=t.getId(),i=n(e,t);return a.has(e)?(alert("Deductible amount option already exists."),!1):(a.add(e,i),o(),!0)}function n(t,e){var n=new Map(t);return n.add(AGE_FROM,e.getAgeFrom()),n.add(AGE_TILL,e.getAgeTill()),n.add(SURCHARGE_OR_DISCOUNT,e.getSurchargeOrDiscount()),n.add(AGGREGATE_POLICY_LIMIT,e.getAggregatePolicyLimit()),n.add(DEDUCTIBLE,e.getDeductible()),n}function o(){var t=i();r.setData(t)}function i(){return a.getEncoder().encode()}var r,a;return{init:function(t){(r=t).getData()},onNewOptionRequest:function(t,e){0==t||0==e?r.onEmptyDeductiblesOrAggregatePolicyLimits():r.showNewOptionDataInput()},onDeductiblesChanged:function(t){r.updateDeductibles(t)},onAggregatePolicyLimitsChanged:function(t){r.updateAggregatePolicyLimits(t)},onOptionAdded:function(t){return e(t)},removeOption:function(e){return t(e)},setData:function(t){a=t,o()}}};console.log("IM DeductibleAmountOptionsTableModel");var DeductibleAmountOptionsTableModel=function(){var t;return{init:function(e){t=e},setData:function(e){t.setData(e)},onOptionAdded:function(e){t.onItemAdded(e)},onOptionRemoved:function(e){t.onItemRemoved(e)}}};console.log("IM DeductibleAmountOptionsController");var DeductibleAmountOptionsController=function(){function t(){(T=new DeductibleAmountOptionsModel).init(h)}function e(){(h=new DeductibleAmountOptionsView).init(f,E)}function n(){(_=new DeductibleAmountOptionsTableView).init()}function o(){(g=new DeductibleAmountOptionsTableModel).init(_)}function i(t){(v=r(t))||c(),T.setData(v),g.setData(v)}function r(t){var e,n=new MapJsonDecoder(t);try{e=n.decode()}catch(e){return void s("Deductible amount options json parse error. Data was: "+t+"  New collection created.")}return e}function a(t){var e=new Map(t.getId());return e.add(AGE_FROM,t.getAgeFrom()),e.add(AGE_TILL,t.getAgeTill()),e.add(AGGREGATE_POLICY_LIMIT,t.getAggregatePolicyLimit()),e.add(SURCHARGE_OR_DISCOUNT,t.getSurchargeOrDiscount()),e.add(DEDUCTIBLE,t.getDeductible()),e}function s(t){console.error(t)}function c(){v=new Map("deductibleAmountOptions")}function u(){EventBus.addEventListener(NEW_DEDUCTIBLE_AMOUNT_OPTION_REQUEST,d),EventBus.addEventListener(NEW_DEDUCTIBLE_AMOUNT_OPTION_CREATION,p),EventBus.addEventListener(ON_DEDUCTIBLE_AMOUNT_OPTIONS_DATA,i),EventBus.addEventListener(REMOVE_DEDUCTIBLE_AMOUNT_OPTION_REQUEST,l)}function l(t){var e=T.removeOption(t);g.onOptionRemoved(e)}function d(){var t=f.length,e=E.length;T.onNewOptionRequest(t,e)}function p(t){if(T.onOptionAdded(t)){var e=a(t);g.onOptionAdded(e)}else console.log("option didn't add")}var f,E,h,T,g,_,v;return{init:function(i,r){n(),o(),u(),f=i,E=r,e(),t()},updateDeductibles:function(t){f=t,T.onDeductiblesChanged(f)},updateAggregatePolicyLimits:function(t){E=t,T.onAggregatePolicyLimitsChanged(E)}}};console.log("IM AddNewDeductibleAmountOptionButton");var AddNewDeductibleAmountOptionButton=function(){function t(){o=i("#addDeductibleAmountOptionButton")}function e(){o.on("click",function(){n()})}function n(){EventBus.dispatchEvent(NEW_DEDUCTIBLE_AMOUNT_OPTION_REQUEST)}var o,i=jQuery.noConflict();return{init:function(){t(),e()}}};console.log("IM DeductibleAmountOptionsMetabox");var DeductibleAmountOptionsMetabox=function(){function t(t,n){(e=new DeductibleAmountOptionsController).init(t,n)}var e;return{init:function(e,n){t(e,n)},updateDeductiblesCollection:function(t){e.updateDeductibles(t)},updateAggregatePolicyLimitsCollection:function(t){e.updateAggregatePolicyLimits(t)}}};console.log("IM DeductibleAmountOption");var DeductibleAmountOption=function(){var t,e,n,o,i,r;return{construct:function(a,s,c,u,l,d){t=a,e=s,n=c,o=u,i=l,r=d},getId:function(){return t},getAgeFrom:function(){return e},getAgeTill:function(){return n},getSurchargeOrDiscount:function(){return o},getAggregatePolicyLimit:function(){return i},getDeductible:function(){return r}}};console.log("IM FamilyRateMaxAgeMetabox");var FamilyRateMaxAgeMetabox=function(){function t(){n=o("#familyRateMaxAgeMetaBoxEditor")}function e(){n.on("keypress",function(t,e){return TextInputUtils.isOnlyNumbersWithDot(t)}),n.on("keyup",function(t,e){var n=parseFloat(o(this).val());n>100?(n=100,o(this).val(n)):n<0&&(n=0,o(this).val(n))})}var n,o=jQuery.noConflict();return{init:function(){console.log("FRMAMetabox"),t(),e()}}};console.log("IM TableController");var TableController=function(){function t(){T=E("#"+h),g=T.val()}function e(){(new TableRendererListener).init(D,C)}function n(t,e,n){_.get(t).update(e,Math.round(1e3*parseFloat(n))),o(g=MapUtils.getMapJson(_))}function o(t){T.val(t)}function i(){MapUtils.setAllValuesToZero(_),o(g=MapUtils.getMapJson(_)),r(),e()}function r(){D.html("");var t=TableFactory.createTable(C,m,_);D.html(t)}function a(){_=CreateEmptyTableDataProvider.create(C)}function s(t){D.html(t)}function c(t,e,n){return TableFactory.createTable(t,e,n)}function u(t){if(t.type==BENEFIT_AMOUNT){var e=t.item,n=new Map(e);C==SCCC_TABLE?p(n,0,A):C==STANDARD_RATES_TABLE&&p(n,0,A),_.add(e,n),d()}}function l(t){if(t.type==BENEFIT_AMOUNT){var e=t.item;_.remove(e),d()}}function d(){o(g=MapUtils.getMapJson(_)),s(c(C,m,_)),e()}function p(t,e,n){console.log("fillMapWithZeroValues");for(var o=e;o<n;o++)t.add(o,0)}function f(){EventBus.addEventListener(COLLECTION_ITEM_ADDED,u),EventBus.addEventListener(COLLECTION_ITEM_REMOVED,l)}var E,h,T,g,_,v,D,C,m="tableId",A=100;return{init:function(n,i,r,u){E=jQuery,C=n,m=i,h=r,D=E("#"+(v=u)),t(),f(),g?_=MapUtils.createMapFromJson(g):(a(),o(g=MapUtils.getMapJson(_))),s(c(C,m,_)),e()},valueChanged:function(t,e,o){n(t,e,o)},clear:function(){i()}}};console.log("IM RatesTableView");var RatesTableView=function(){function t(){e(),u()}function e(){EventBus.addEventListener(ON_RATE_ADDED,n),EventBus.addEventListener(ON_RATE_REMOVED,o)}function n(t){i(t)}function o(t){c(t)}function i(t){var e=t.id,n=E(t);r(n),a(e,n),u()}function r(t){t.appendTo(D)}function a(t,e){A.add(t,e)}function s(t){A.remove(t)}function c(t){f(A.get(t)),s(t)}function u(){l(),C(".removeRowButtonTableItemRenderer[collectiontype="+RATE+"]").on("click",function(){m=C(this).attr("id"),p()})}function l(){C(".removeRowButtonTableItemRenderer[collectiontype="+RATE+"]").off("click")}function d(){console.log("buildRemoveRateConfirmationDialogContent"),console.log("idToRemove: "+m);var t=v.get(m),e=t.get(AGE_FROM),n=t.get(AGE_TILL),o=t.get(MEDICAL_DECLARATION_REQUIRED),i=t.get(PREMIUM_TABLE),r=t.get(DEDUCTIBLE);return o=0==o?"No":"Yes","<div>Really want to delete rate with data:<br/>age from:  "+e+"<br/>age till:  "+n+"<br/>Medical declaration required: "+o+"<br/>premium table:  "+i+"<br/>deductible:  "+r+"</div>"}function p(){var t=d();C(t).dialog({title:"Remove rate confirmation",modal:!0,buttons:[{text:"Yes",click:function(){EventBus.dispatchEvent(REMOVE_RATE_REQUEST,m),C(this).dialog("close")}},{text:"No",click:function(){C(this).dialog("close")}}]})}function f(t){t.remove()}function E(t){var e=t.id,n=t.ageFrom,o=t.ageTill,i=t.sccOption,r=t.mdr,a=t.premiumTable,s=t.deductible,c=(new AgeRangeFormatter).format(n,o);return r=0==r?"No":"Yes",a=a==SCCC_MAP_ID?"STABLE CHRONIC CONDITION":"STANDARD RATES",1==i?i="Yes":0==i?i="No":-1==i&&(i="Not available"),C('<tr id="'+e+'"><td class="fullwidth centered"><input data-type="rate" collectiontype="'+RATE+'" class="removeRowButtonTableItemRenderer" type="button" id="'+e+'" value="Remove"></td><td class="fullwidth centered">'+c+'</td><td class="fullwidth centered">'+i+'</td><td class="fullwidth centered">'+r+'</td><td class="fullwidth centered">'+a+'</td><td class="fullwidth centered">'+s+"</td></tr>")}function h(){D=C("#"+RATES_TABLE_ID)}function T(){for(var t=v.getKeys(),e=0;e<t.length;e++){var n=v.get(t[e]);i({id:n.getId(),ageFrom:n.get(AGE_FROM),ageTill:n.get(AGE_TILL),sccOption:n.get(STABLE_CHRONIC_CONDITION_OPTION),mdr:n.get(MEDICAL_DECLARATION_REQUIRED),premiumTable:n.get(PREMIUM_TABLE),deductible:n.get(DEDUCTIBLE)})}}function g(){D.hide()}function _(){D.show()}var v,D,C,m,A=new Map("rows");return{init:function(e){C=jQuery.noConflict(),v=e,h(),T(),t()},hide:function(){g()},show:function(){_()}}};console.log("IM AdminAppInit - plane js. No class");var $=jQuery.noConflict();$(document).ready(function(t){function e(){EventBus.removeEventListener(RENDERER_VALUE_CHANGED,o),EventBus.addEventListener(RENDERER_VALUE_CHANGED,o)}function n(){e()}function o(t){console.log("value changed");var e=t.context,n=t.rowId,o=t.columnKey,i=t.newValue;e===SCCC_TABLE?c.valueChanged(n,o,i):e===STANDARD_RATES_TABLE?u.valueChanged(n,o,i):console.error("Unknown context.")}function i(t){var e=t.context;e===SCCC_TABLE?c.clear():e===STANDARD_RATES_TABLE?u.clear():console.error("Unknown context.")}function r(t){var e=t.type;e==DEDUCTIBLE?f.updateDeductiblesCollection(d.getValues()):e==BENEFIT_AMOUNT&&f.updateAggregatePolicyLimitsCollection(l.getValues())}var a,s,c=new TableController;c.init(SCCC_TABLE,"scccTable","scccTable_editor","scccTableContainer");var u=new TableController;u.init(STANDARD_RATES_TABLE,"standardRatesTable","standardRatesTable_editor","standardRatesTableContainer");var l,d,p,f;!function(){(a=new ClearTableButton).init(t("#clearScccTableButton"),SCCC_TABLE),(s=new ClearTableButton).init(t("#clearStandardRatesTableButton"),STANDARD_RATES_TABLE)}(),function(){EventBus.addEventListener(CLEAR_TABLE_BUTTON_CLICK,i)}(),e(),function(){console.log("createBenefitsMetaBox"),(l=new CollectionMetaBox).init(BENEFIT_AMOUNT,"addBenefitButton","removeBenefitButton","benefitsSelect","benefitsEditorInput","benefits")}(),function(){(d=new CollectionMetaBox).init(DEDUCTIBLE,"addDeductibleButton","removeDeductibleButton","deductiblesSelect","deductiblesEditorInput","deductibles")}(),function(){var t=d.getValues();(p=new RatesMetaBox).init(RATE,"addRateButton","removeRateButton","rateTableSelect",RATE_TABLE_EDITOR_ID,"rates",t)}(),function(){var t=d.getValues(),e=l.getValues();(f=new DeductibleAmountOptionsMetabox).init(t,e),EventBus.addEventListener(COLLECTION_ITEM_ADDED,r),EventBus.addEventListener(COLLECTION_ITEM_REMOVED,r)}(),function(){(new FamilyRateMaxAgeMetabox).init()}(),function(){(new QuestionaryAdminInitor).create()}(),EventBus.addEventListener(NEW_TABLE_ROW_ADDED,n)}),console.log("IM QuoteEditAdminView");var QuoteEditAdminView=function(){function t(){this.$j=jQuery.noConflict();var t=this.$j("#quoteData").text();try{this.quotedata=JSON.parse(t),console.log("quote data: ",this.quotedata)}catch(t){return void console.error("quoteData is not json")}this.updateChildren(),this.createStateDropDownListener(),this.persons=this.getPersons(),this.iteratePersons()}return t.prototype.getPersons=function(){var t=this.$j("#personsData").html();return new PersonCollectionParser(t).parse()},t.prototype.iteratePersons=function(){for(var t=this.persons.getIterator();t.hasNext();){var e=t.next();new QuotePersonAdminView(e,this.$j("#personsContainer"))}},t.prototype.updateChildren=function(){this.$j("#benefitContainer").text(StringUtils.formatMoneyInt(this.quotedata.benefit)),this.$j("#deductibleContainer").text(StringUtils.formatMoneyInt(this.quotedata.deductible)),this.$j("#costContainer").text(StringUtils.formatDivisionalMoney(this.quotedata.cost)),this.$j("#periodContainer").text(this.quotedata.period+" day(s)"),this.$j("#startDateContainer").text(this.quotedata.startDate),this.$j("#finishDateContainer").text(this.quotedata.finishDate)},t.prototype.createStateDropDownListener=function(){var t=this;this.$j("#stateDropDown").change(function(){return t.onStateDropDownChanged()})},t.prototype.onStateDropDownChanged=function(){console.log("onStateDropDownChanged to "+this.$j("#stateDropDown").val()),this.$j("#applicationState").val(this.$j("#stateDropDown").val())},t}();console.log("IM TableRendererListener");var TableRendererListener=function(){function t(t,e,n){EventBus.dispatchEvent(RENDERER_VALUE_CHANGED,{rowId:t,columnKey:e,newValue:n,context:o})}function e(t,e){e<0?t.addClass("negativeValue"):t.removeClass("negativeValue")}var n,o;return{init:function(i,r){n=jQuery,o=r,i.find(".tableCeilItemRenderer").on("keypress",function(t,e){return TextInputUtils.isOnlyNumbersWithDot(t)}),i.find(".tableCeilItemRenderer").on("keyup",function(o,i){var r=parseFloat(n(this).val());r<-1&&(r=-1,n(this).val(r)),e(n(this),r),t(n(this).data("rowid"),n(this).data("columnkey"),n(this).val())})}}};console.log("IM PersonCollectionParser");var PersonCollectionParser=function(){function t(t){this.$j=jQuery.noConflict(),this.data=t}return t.prototype.parse=function(){var t=unescape(this.data),e=new MapJsonDecoder(t).decode();return this.parsePersons(e)},t.prototype.parsePersons=function(t){for(var e=new QuotePersonCollection,n=t.getIterator();n.hasNext();){var o=n.next();e.add(this.parsePerson(o))}return e},t.prototype.parsePerson=function(t){var e=t._age,n=t._firstName,o=t._lastName,i=t._gender,r=t._relationship,a=t._questions,s=t._birthday,c=t._complete,u=t._useSCCC,l=t._period,d=t._medicalDeclarationRequired,p=this.parseQuestions(a),f=new QuotePerson(e,n,o,i,r,s,p);return f.setIsComplete(c),f.setIsUseSCCC(u),f.setPeriod(l),f.setMedicalDeclarationRequired(d),f},t.prototype.parseQuestions=function(t){var e="";return console.log("parse questions ",t),this.$j.isEmptyObject(t)||(t.collection.items.id="questions",t.collection.items.type="Map",e=JSON.stringify(t.collection.items)),e},t}();console.log("IM QuotePerson");var QuotePerson=function(){function t(t,e,n,o,i,r,a){this._medicalDeclarationRequired=!1,this._complete=!1,this._confirmed=!1,this._useSCCC=!1,this._age=t,this._firstName=e,this._lastName=n,this._gender=o,this._relationship=i,this._birthday=r,this._questions=a,this._firstName||(this._firstName=""),this._lastName||(this._lastName=""),this._gender||(this._gender=""),this._relationship||(this._relationship=""),this._birthday||(this._birthday=""),this._questions||(this._questions={})}return t.prototype.getLastName=function(){return this._lastName},t.prototype.setLastName=function(t){this._lastName=t},t.prototype.getFirstName=function(){return this._firstName},t.prototype.setFirstName=function(t){this._firstName=t},t.prototype.getAge=function(){return this._age},t.prototype.setAge=function(t){this._age=t},t.prototype.getRelationship=function(){return this._relationship},t.prototype.setRelationship=function(t){this._relationship=t},t.prototype.getBirthday=function(){return this._birthday},t.prototype.setBirthday=function(t){this._birthday=t},t.prototype.getGender=function(){return this._gender},t.prototype.setGender=function(t){this._gender=t},t.prototype.getQuestions=function(){return this._questions},t.prototype.setQuestions=function(t){this._questions=t},t.prototype.setIsComplete=function(t){this._complete=t},t.prototype.getIsComplete=function(){return this._complete},t.prototype.getMedicalDeclarationRequired=function(){return this._medicalDeclarationRequired},t.prototype.setMedicalDeclarationRequired=function(t){this._medicalDeclarationRequired=t},t.prototype.getIsUseSCCC=function(){return this._useSCCC},t.prototype.setIsUseSCCC=function(t){this._useSCCC=t},t.prototype.getIsConfirmed=function(){return this._confirmed},t.prototype.setIsConfirmed=function(t){this._confirmed=t},t.prototype.getPeriod=function(){return this._period},t.prototype.setPeriod=function(t){this._period=t},t}();console.log("IM QuotePersonCollection");var QuotePersonCollection=function(){function t(){this.createCollection()}return t.prototype.createCollection=function(){this.collection=new Map("persons")},t.prototype.add=function(t){var e="_"+Math.round(1e5*Math.random());this.collection.add(e,t)},t.prototype.getAges=function(){for(var t=new Array,e=this.collection.getIterator();e.hasNext();){var n=e.next().getAge();t.push(n.toString())}return t},t.prototype.size=function(){return this.collection.size()},t.prototype.getIterator=function(){return this.collection.getIterator()},t.prototype.setData=function(t){this.collection=this.parseData(t)},t.prototype.getData=function(){return this.collection.getEncoder().encode()},t.prototype.getPersonByAge=function(t){for(var e=this.collection.getIterator();e.hasNext();){var n=e.next();if(n.getAge()==t)return n}},t.prototype.parseData=function(t){return new MapJsonDecoder(t).decode()},t}();console.log("IM QuotePersonAdminView");var QuotePersonAdminView=function(){function t(t,e){this.$j=jQuery.noConflict(),this.person=t,this.container=e,this.createChildren()}return t.prototype.createChildren=function(){this.createPersonDataView(),this.createQuestionsContainer(),this.createQuestionsView()},t.prototype.createPersonDataView=function(){var t=this.person.getRelationship()==PRIMARY;console.log("person is primary: "+t);var e=this.person.getRelationship();console.log("person "+this.person.getFirstName()+"  relationship: "+this.person.getRelationship()),this.personContainer=t?this.$j("<div><h2 style='text-align: center; width: 100%; background-color: #d9edf7; text-align: center;'><span class='glyphicon glyphicon-user' aria-hidden='true'></span>  <b>Primary Insured</b></h2></div>"):this.$j("<div><h2 style='text-align: center; width: 100%; background-color: #d9edf7; text-align: center;'><span class='glyphicon glyphicon-user' aria-hidden='true'></span>  <b>Insured ("+e+")</b></h2></div>");var n=this.$j("<table style='font-size:1.8em;'><tbody></tbody></table>"),o=this.$j("<tr></tr>"),i=this.$j("<td>First name:</td>"),r=this.$j("<td>"+this.person.getFirstName()+"</td>"),a=this.$j("<td>Last name:</td>"),s=this.$j("<td>"+this.person.getLastName()+"</td>");o.append(i),o.append(r),o.append(a),o.append(s);var c=this.$j("<tr></tr>"),i=this.$j("<td>Birthday:</td>"),r=this.$j("<td>"+this.person.getBirthday()+"</td>"),a=this.$j("<td>Age:</td>"),s=this.$j("<td>"+this.person.getAge()+"</td>");c.append(i),c.append(r),c.append(a),c.append(s);var u=this.$j("<tr></tr>"),i=this.$j("<td>Gender:</td>"),r=this.$j("<td>"+this.person.getGender()+"</td>");if(u.append(i),u.append(r),n.append(o),n.append(c),n.append(u),!t){var l=this.$j("<tr></tr>"),i=this.$j("<td>Relationship:</td>"),r=this.$j("<td>"+this.person.getRelationship()+"</td>");l.append(i),l.append(r),n.append(l)}this.personContainer.append(n),this.container.append(this.personContainer)},t.prototype.createQuestionsView=function(){var t=this.person.getQuestions();new FrontendUserAnswers(t,this.questionsContainerId)},t.prototype.createQuestionsContainer=function(){this.questionsContainerId="questions_"+Math.round(1e5*Math.random()),this.questionsContainer=this.$j("<div id='"+this.questionsContainerId+"'><h1 style='width: 100%; background-color: #dff0d8; text-align: center;'>Medical declaration questions</h1></div>"),this.personContainer.append(this.questionsContainer)},t}();console.log("IM QuotePersonAdminView");